<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HorizonDatabasePlugin: PostgreSQL Backend Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HorizonDatabasePlugin
   &#160;<span id="projectnumber">0.1.0</span>
   </div>
   <div id="projectbrief">SOCI wrapper for UE4(beta)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">PostgreSQL Backend Reference </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><ul>
<li><a href="#prerequisites">Prerequisites</a><ul>
<li><a href="#versions">Supported Versions</a></li>
<li><a href="#tested">Tested Platforms</a></li>
<li><a href="#required">Required Client Libraries</a></li>
</ul>
</li>
<li><a href="#connecting">Connecting to the Database</a></li>
<li><a href="#support">SOCI Feature Support</a><ul>
<li><a href="#dynamic">Dynamic Binding</a></li>
<li><a href="#name">Binding by Name</a></li>
<li><a href="#bulk">Bulk Operations</a></li>
<li><a href="#transactions">Transactions</a></li>
<li><a href="#blob">BLOB Data Type</a></li>
<li><a href="#rowid">RowID Data Type</a></li>
<li><a href="#nested">Nested Statements</a></li>
<li><a href="#stored">Stored Procedures</a></li>
</ul>
</li>
<li><a href="#native">Accessing the Native Database API</a></li>
<li><a href="#extensions">Backend-specific Extensions</a><ul>
<li><a href="#uuid">UUID Data Type</a></li>
</ul>
</li>
<li><a href="#configuration">Configuration options</a></li>
</ul>
<h3><a class="anchor" id="prerequisites"></a> Prerequisites</h3>
<h4><a class="anchor" id="versions"></a> Supported Versions</h4>
<p>The SOCI PostgreSQL backend is supported for use with PostgreSQL &gt;= 7.3, although versions older than 8.0 will suffer from limited feature support. See below for details.</p>
<h4><a class="anchor" id="tested"></a> Tested Platforms</h4>
<table class="doxtable">
</table>
<p>PostgreSQL version</p>
<p>Operating System</p>
<p>Compiler </p>
<p>9.0</p>
<p>Mac OS X 10.6.6</p>
<p>g++ 4.2 </p>
<p>8.4</p>
<p>FreeBSD 8.2</p>
<p>g++ 4.1 </p>
<p>8.4</p>
<p>Debian 6</p>
<p>g++ 4.3 </p>
<p>8.4</p>
<p>RedHat 5</p>
<p>g++ 4.3 &lt;/tbody&gt; </p>
<h4><a class="anchor" id="required"></a> Required Client Libraries</h4>
<p>The SOCI PostgreSQL backend requires PostgreSQL's <code>libpq</code> client library.</p>
<p>Note that the SOCI library itself depends also on <code>libdl</code>, so the minimum set of libraries needed to compile a basic client program is: </p><pre class="fragment">-lsoci_core -lsoci_postgresql -ldl -lpq
</pre><h4><a class="anchor" id="connecting"></a> Connecting to the Database</h4>
<p>To establish a connection to the PostgreSQL database, create a <code>session</code> object using the <code>postgresql</code> backend factory together with a connection string:</p>
<pre class="fragment">session sql(postgresql, "dbname=mydatabase");

// or:
session sql("postgresql", "dbname=mydatabase");

// or:
session sql("postgresql://dbname=mydatabase");
</pre><p>The set of parameters used in the connection string for PostgreSQL is the same as accepted by the <code>[PQconnectdb](<a href="http://www.postgresql.org/docs/8.3/interactive/libpq.html#LIBPQ-CONNECT">http://www.postgresql.org/docs/8.3/interactive/libpq.html#LIBPQ-CONNECT</a>)</code> function from the <code>libpq</code> library.</p>
<p>Once you have created a <code>session</code> object as shown above, you can use it to access the database, for example: </p><pre class="fragment">int count;
sql &lt;&lt; "select count(*) from invoices", into(count);
</pre><p>(See the [exchanging data](../basics.html"&gt;SOCI basics&lt;/a&gt; and &lt;a href="../exchange.html) documentation for general information on using the <code>session</code> class.)</p>
<h3><a class="anchor" id="features"></a> SOCI Feature Support</h3>
<h4><a class="anchor" id="dynamic"></a> Dynamic Binding</h4>
<p>The PostgreSQL backend supports the use of the SOCI <code>row</code> class, which facilitates retrieval of data whose type is not known at compile time.</p>
<p>When calling <code>row::get&lt;T&gt;()</code>, the type you should pass as <code>T</code> depends upon the underlying database type.<br />
 For the PostgreSQL backend, this type mapping is:</p>
<table class="doxtable">
</table>
<p>PostgreSQL Data Type </p>
<p>SOCI Data Type </p>
<p><code>row::get&lt;T&gt;</code> specializations  </p>
<p>numeric, real, double </p>
<p><code>dt_double</code> </p>
<p><code>double</code>  </p>
<p>boolean, smallint, integer </p>
<p><code>dt_integer</code> </p>
<p><code>int</code>  </p>
<p>int8 </p>
<p><code>dt_long_long</code> </p>
<p><code>long long</code>  </p>
<p>oid </p>
<p><code>dt_integer</code> </p>
<p><code>unsigned long</code>  </p>
<p>char, varchar, text, cstring, bpchar </p>
<p><code>dt_string</code> </p>
<p><code>std::string</code>  </p>
<p>abstime, reltime, date, time, timestamp, timestamptz, timetz </p>
<p><code>dt_date</code> </p>
<p><code>std::tm</code>  &lt;/tbody&gt; </p>
<p>(See the <a href="../exchange.html#dynamic">dynamic resultset binding</a> documentation for general information on using the <code>row</code> class.)</p>
<h4><a class="anchor" id="name"></a> Binding by Name</h4>
<p>In addition to <a href="../exchange.html#bind_position">binding by position</a>, the PostgreSQL backend supports <a href="../exchange.html#bind_name">binding by name</a>, via an overload of the <code><a class="el" href="namespacesoci.html#a9f59a2e8d19664d5e1eae175936f1b4e">use()</a></code> function: </p><pre class="fragment">int id = 7;
sql &lt;&lt; "select name from person where id = :id", use(id, "id")
</pre><p>Apart from the portable "colon-name" syntax above, which is achieved by rewriting the query string, the backend also supports the PostgreSQL native numbered syntax: </p><pre class="fragment">int i = 7;
int j = 8;
sql &lt;&lt; "insert into t(x, y) values($1, $2)", use(i), use(j);
</pre><p>The use of native syntax is not recommended, but can be nevertheless imposed by switching off the query rewriting. This can be achieved by defining the macro <code>SOCI_POSTGRESQL_NOBINDBYNAME</code> and it is actually necessary for PostgreSQL 7.3, in which case binding of use elements is not supported at all. See the <a href="#options">Configuration options</a> section for details.</p>
<h4><a class="anchor" id="bulk"></a> Bulk Operations</h4>
<p>The PostgreSQL backend has full support for SOCI's <a href="../statements.html#bulk">bulk operations</a> interface.</p>
<h4><a class="anchor" id="transactions"></a> Transactions</h4>
<p><a href="../statements.html#transactions">Transactions</a> are also fully supported by the PostgreSQL backend.</p>
<h4><a class="anchor" id="blob"></a> blob Data Type</h4>
<p>The PostgreSQL backend supports working with data stored in columns of type Blob, via SOCI's <a href="../exchange.html#blob">blob</a> class with the exception that trimming is not supported.</p>
<h4><a class="anchor" id="rowid"></a> rowid Data Type</h4>
<p>The concept of row identifier (OID in PostgreSQL) is supported via SOCI's <a href="../reference.html#rowid">rowid</a> class.</p>
<h4><a class="anchor" id="nested"></a> Nested Statements</h4>
<p>Nested statements are not supported by PostgreSQL backend.</p>
<h4><a class="anchor" id="stored"></a> Stored Procedures</h4>
<p>PostgreSQL stored procedures can be executed by using SOCI's <a href="../statements.html#procedures">procedure</a> class.</p>
<h3><a class="anchor" id="native"></a> Acessing the native database API</h3>
<p>SOCI provides access to underlying datbabase APIs via several <code>get_backend()</code> functions, as described in the <a href="../beyond.html">beyond SOCI</a> documentation.</p>
<p>The PostgreSQL backend provides the following concrete classes for navite API access:</p>
<table class="doxtable">
</table>
<p>Accessor Function </p>
<p>Concrete Class  </p>
<p><code>session_backend * session::get_backend()</code> </p>
<p><code>postgresql_session_backend</code>  </p>
<p><code>statement_backend * statement::get_backend()</code> </p>
<p><code>postgresql_statement_backend</code>  </p>
<p><code>blob_backend * blob::get_backend()</code> </p>
<p><code>postgresql_blob_backend</code>  </p>
<p><code>rowid_backend * rowid::get_backend()</code> </p>
<p><code>postgresql_rowid_backend</code>  &lt;/tbody&gt; </p>
<h3><a class="anchor" id="extensions"></a> Backend-specific extensions</h3>
<h4><a class="anchor" id="uuid"></a> uuid Data Type</h4>
<p>The PostgreSQL backend supports working with data stored in columns of type UUID via simple string operations. All string representations of UUID supported by PostgreSQL are accepted on input, the backend will return the standard format of UUID on output. See the test <code>test_uuid_column_type_support</code> for usage examples.</p>
<h3><a class="anchor" id="configuration"></a> Configuration options</h3>
<p>To support older PostgreSQL versions, the following configuration macros are recognized:</p>
<ul>
<li><code>SOCI_POSTGRESQL_NOBINDBYNAME</code> - switches off the query rewriting.</li>
<li><code>SOCI_POSTGRESQL_NOPARAMS</code> - disables support for parameterized queries (binding of use elements),automatically imposes also the <code>SOCI_POSTGRESQL_NOBINDBYNAME</code> macro. It is necessary for PostgreSQL 7.3.</li>
<li><code>SOCI_POSTGRESQL_NOPREPARE</code> - disables support for separate query preparation, which in this backend is significant only in terms of optimization. It is necessary for PostgreSQL 7.3 and 7.4. </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.12
</small></address>
</body>
</html>
