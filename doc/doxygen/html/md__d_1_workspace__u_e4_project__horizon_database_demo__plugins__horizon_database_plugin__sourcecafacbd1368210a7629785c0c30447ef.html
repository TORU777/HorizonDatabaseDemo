<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HorizonDatabasePlugin: Oracle Backend Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HorizonDatabasePlugin
   &#160;<span id="projectnumber">0.1.0</span>
   </div>
   <div id="projectbrief">SOCI wrapper for UE4(beta)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Oracle Backend Reference </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><ul>
<li><a href="#prerequisites">Prerequisites</a><ul>
<li><a href="#versions">Supported Versions</a></li>
<li><a href="#tested">Tested Platforms</a></li>
<li><a href="#required">Required Client Libraries</a></li>
</ul>
</li>
<li><a href="#connecting">Connecting to the Database</a></li>
<li><a href="#support">SOCI Feature Support</a><ul>
<li><a href="#dynamic">Dynamic Binding</a></li>
<li><a href="#name">Binding by Name</a></li>
<li><a href="#bulk">Bulk Operations</a></li>
<li><a href="#transactions">Transactions</a></li>
<li><a href="#blob">BLOB Data Type</a></li>
<li><a href="#rowid">RowID Data Type</a></li>
<li><a href="#nested">Nested Statements</a></li>
<li><a href="#stored">Stored Procedures</a></li>
</ul>
</li>
<li><a href="#native">Accessing the Native Database API</a></li>
<li><a href="#extensions">Backend-specific Extensions</a><ul>
<li><a href="#oraclesocierror">oracle_soci_error</a></li>
</ul>
</li>
</ul>
<h3><a class="anchor" id="prerequisites"></a> Prerequisites</h3>
<h4><a class="anchor" id="versions"></a> Supported Versions</h4>
<p>The SOCI Oracle backend is currently supported for use with Oracle 10 or later. Older versions of Oracle may work as well, but they have not been tested by the SOCI team.</p>
<h4><a class="anchor" id="tested"></a> Tested Platforms</h4>
<table class="doxtable">
</table>
<p>Oracle version</p>
<p>Operating System</p>
<p>Compiler </p>
<p>10.2.0 (XE)</p>
<p>RedHat 5</p>
<p>g++ 4.3 &lt;/tbody&gt; </p>
<h4><a class="anchor" id="required"></a> Required Client Libraries</h4>
<p>The SOCI Oracle backend requires Oracle's <code>libclntsh</code> client library. Depending on the particular system, the <code>libnnz10</code> library might be needed as well.</p>
<p>Note that the SOCI library itself depends also on <code>libdl</code>, so the minimum set of libraries needed to compile a basic client program is: </p><pre class="fragment">-lsoci_core -lsoci_oracle -ldl -lclntsh -lnnz10
</pre><h4><a class="anchor" id="connecting"></a> Connecting to the Database</h4>
<p>To establish a connection to an Oracle database, create a <code>session</code> object using the oracle backend factory together with a connection string: </p><pre class="fragment">session sql(oracle, "service=orcl user=scott password=tiger");

// or:
session sql("oracle", "service=orcl user=scott password=tiger");

// or:
session sql("oracle://service=orcl user=scott password=tiger");
</pre><p>The set of parameters used in the connection string for Oracle is:</p>
<ul>
<li><code>service</code></li>
<li><code>user</code></li>
<li><code>password</code></li>
<li><code>mode</code> (optional)</li>
</ul>
<p>Once you have created a <code>session</code> object as shown above, you can use it to access the database, for example: </p><pre class="fragment">int count;
sql &lt;&lt; "select count(*) from user_tables", into(count);
</pre><p>(See the <a href="../basics.html">SOCI basics</a> and <a href="../exchange.html">exchanging data</a> documentation for general information on using the <code>session</code> class.)#</p>
<h3><a class="anchor" id="features"></a> SOCI Feature Support</h3>
<h4><a class="anchor" id="dynamic"></a> Dynamic Binding</h4>
<p>The Oracle backend supports the use of the SOCI <code>row</code> class, which facilitates retrieval of data which type is not known at compile time.</p>
<p>When calling <code>row::get&lt;T&gt;()</code>, the type you should pass as <code>T</code> depends upon the nderlying database type.<br />
 For the Oracle backend, this type mapping is:</p>
<table class="doxtable">
</table>
<p>Oracle Data Type </p>
<p>SOCI Data Type </p>
<p><code>row::get&lt;T&gt;</code> specializations  </p>
<p>number <em>(where scale &gt; 0)</em> </p>
<p><code>dt_double</code> </p>
<p><code>double</code>  </p>
<p>number<br />
<em>(where scale = 0 and precision &le; std::numeric_limits&lt;int&gt;::digits10)</em> </p>
<p><code>dt_integer</code> </p>
<p><code>int</code>  </p>
<p>number </p>
<p><code>dt_long_long</code> </p>
<p><code>long long</code>  </p>
<p>char, varchar, varchar2 </p>
<p><code>dt_string</code> </p>
<p><code>std::string</code>  </p>
<p>date </p>
<p><code>dt_date</code> </p>
<p><code>std::tm</code>  &lt;/tbody&gt; </p>
<p>(See the <a href="../exchange.html#dynamic">dynamic resultset binding</a> documentation for general information on using the <code>row</code> class.)</p>
<h4><a class="anchor" id="name"></a> Binding by Name</h4>
<p>In addition to <a href="../exchange.html#bind_position">binding by position</a>, the Oracle backend supports <a href="../exchange.html#bind_name">binding by name</a>, via an overload of the <code><a class="el" href="namespacesoci.html#a9f59a2e8d19664d5e1eae175936f1b4e">use()</a></code> function: </p><pre class="fragment">int id = 7;
sql &lt;&lt; "select name from person where id = :id", use(id, "id")
</pre><p>SOCI's use of ':' to indicate a value to be bound within a SQL string is consistant with the underlying Oracle client library syntax.</p>
<h4><a class="anchor" id="bulk"></a> Bulk Operations</h4>
<p>The Oracle backend has full support for SOCI's <a href="../statements.html#bulk">bulk operations</a> interface.</p>
<h4><a class="anchor" id="transactions"></a> Transactions</h4>
<p><a href="../statements.html#transactions">Transactions</a> are also fully supported by the Oracle backend, although transactions with non-default isolation levels have to be managed by explicit SQL statements.</p>
<h4><a class="anchor" id="blob"></a> blob Data Type</h4>
<p>The Oracle backend supports working with data stored in columns of type Blob, via SOCI's <a href="../exchange.html#blob">blob</a> class.</p>
<h4><a class="anchor" id="rowid"></a> rowid Data Type</h4>
<p>Oracle rowid's are accessible via SOCI's <a href="../reference.html#rowid">rowid</a> class.</p>
<h4><a class="anchor" id="nested"></a> Nested Statements</h4>
<p>The Oracle backend supports selecting into objects of type <code>statement</code>, so that you may work with nested sql statements and PL/SQL cursors: </p><pre class="fragment">statement stInner(sql);
statement stOuter = (sql.prepare &lt;&lt;
    "select cursor(select name from person order by id)"
    " from person where id = 1",
    into(stInner));
stInner.exchange(into(name));
stOuter.execute();
stOuter.fetch();

while (stInner.fetch())
{
    std::cout &lt;&lt; name &lt;&lt; '\n';
}
</pre><h4><a class="anchor" id="stored"></a> Stored Procedures</h4>
<p>Oracle stored procedures can be executed by using SOCI's <a href="../statements.html#procedures">procedure</a> class.</p>
<h3><a class="anchor" id="native"></a> Acessing the native database API</h3>
<p>SOCI provides access to underlying datbabase APIs via several <code>get_backend()</code> functions, as described in the <a href="../beyond.html">Beyond SOCI</a> documentation.</p>
<p>The Oracle backend provides the following concrete classes for navite API access:</p>
<table class="doxtable">
</table>
<p>Accessor Function </p>
<p>Concrete Class  </p>
<p><code>session_backend * session::get_backend()</code> </p>
<p><code>oracle_session_backend</code>  </p>
<p><code>statement_backend * statement::get_backend()</code> </p>
<p><code>oracle_statement_backend</code>  </p>
<p><code>blob_backend * blob::get_backend()</code> </p>
<p><code>oracle_blob_backend</code>  </p>
<p><code>rowid_backend * rowid::get_backend()</code> </p>
<p><code>oracle_rowid_backend</code>  &lt;/tbody&gt; </p>
<h3><a class="anchor" id="extensions"></a> Backend-specific extensions</h3>
<h4><a class="anchor" id="oraclesocierror"></a> oracle_soci_error</h4>
<p>The Oracle backend can throw instances of class <code>oracle_soci_error</code>, which is publicly derived from <code>soci_error</code> and has an additional public <code>err_num_</code> member containing the Oracle error code: </p><pre class="fragment">int main()
{
    try
    {
        // regular code
    }
    catch (oracle_soci_error const &amp;amp; e)
    {
        cerr &lt;&lt; "Oracle error: " &lt;&lt; e.err_num_
          &lt;&lt; " " &lt;&lt; e.what() &lt;&lt; endl;
    }
    catch (exception const &amp;amp;e)
    {
        cerr &lt;&lt; "Some other error: "&lt;&lt; e.what() &lt;&lt; endl;
    }
} </pre> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.12
</small></address>
</body>
</html>
