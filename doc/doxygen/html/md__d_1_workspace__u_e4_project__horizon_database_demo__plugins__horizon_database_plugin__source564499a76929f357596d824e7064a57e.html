<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HorizonDatabasePlugin: Connections and simple queries</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HorizonDatabasePlugin
   &#160;<span id="projectnumber">0.1.0</span>
   </div>
   <div id="projectbrief">SOCI wrapper for UE4(beta)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Connections and simple queries </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h3>Connecting to the database</h3>
<p>The <code>session</code> class encapsulates the database connection and other backend-related details, which are common to all the statements that will be later executed. It has a couple of overloaded constructors.</p>
<p>The most basic one expects two parameters: the requested backend factory object and the generic connection string, which meaning is backend-dependent.</p>
<p>Example: </p><pre class="fragment">session sql(oracle, "service=orcl user=scott password=tiger");
</pre><p>Another example might be: </p><pre class="fragment">session sql(postgresql, "dbname=mydb");
</pre><p>Above, the <code>sql</code> object is a local (automatic) object that encapsulates the connection.</p>
<p>This <code>session</code> constructor either connects successfully, or throws an exception.</p>
<p>Another constructor allows to name backends at run-time and supports the dynamically loadable backends, which have to be compiled as shared libraries. The usage is similar to the above, but instead of providing the factory object, the backend name is expected: </p><pre class="fragment">session sql("postgresql", "dbname=mydb");
</pre><p>For convenience, the URL-like form that combines both the backend name with connection parameters is supported as well: </p><pre class="fragment">session sql("postgresql://dbname=mydb");
</pre><p>The last two constructors described above try to locate the shared library with the name <code>libsoci_ABC.so</code> (or <code>libsoci_ABC.dll</code> on Windows), where ABC is the backend name. In the above examples, the expected library name will be <code>libsoci_postgresql.so</code> for Unix-like systems.</p>
<p>The most general form of the constructor takes a single object of <code>connection_parameters</code> type which contains a pointer to the backend to use, the connection string and also any connection options. Using this constructor is the only way to pass any non-default options to the backend. For example, to suppress any interactive prompts when using ODBC backend you could do: </p><pre class="fragment">connection_parameters parameters("odbc", "DSN=mydb");
parameters.set_option(odbc_option_driver_complete, "0" /* SQL_DRIVER_NOPROMPT */);
session sql(parameters);
</pre><p>Notice that you need to <code>#include &lt;<a class="el" href="soci-odbc_8h.html">soci-odbc.h</a>&gt;</code> to obtain the option name declaration. The existing options are described in the backend-specific part of the documentation.</p>
<h3>Environment configuration</h3>
<p>The <code>SOCI_BACKENDS_PATH</code> environment variable defines the set of paths where the shared libraries will be searched for. There can be many paths, separated by colons, and they are used from left to right until the library with the appropriate name is found. If this variable is not set or is empty, the current directory is used as a default path for dynamically loaded backends.</p>
<p>The run-time selection of backends is also supported with libraries linked statically. Each backend provides a separate function of the form <code>register_factory_*name*</code>, where <code>*name*</code> is a backend name. Thus: </p><pre class="fragment">extern "C" void register_factory_postgresql();
// ...
register_factory_postgresql();
session sql("postgresql://dbname=mydb");
</pre><p>The above example registers the backend for PostgreSQL and later creates the session object for that backend. This form is provided for those projects that prefer static linking but still wish to benefit from run-time backend selection.</p>
<p>An alternative way to set up the session is to create it in the disconnected state and connect later: </p><pre class="fragment">session sql;

// some time later:
sql.open(postgresql, "dbname=mydb");

// or:
sql.open("postgresql://dbname=mydb");

// or also:
connection_parameters parameters("postgresql", "dbname=mydb");
sql.open(parameters);
</pre><p>The rules for backend naming are the same as with the constructors described above.</p>
<p>The session can be also explicitly <code>close</code>d and <code>reconnect</code>ed, which can help with basic session error recovery. The <code>reconnect</code> function has no parameters and attempts to use the same values as those provided with earlier constructor or <code>open</code> calls.</p>
<p>See also the page devoted to <a href="multithreading.html">multithreading</a> for a detailed description of connection pools.</p>
<p>It is possible to have many active <code>session</code>s at the same time, even using different backends.</p>
<h3>Portability note</h3>
<p>The following backend factories are currently (as of 3.1.0 release) available:</p>
<ul>
<li><a href="backends/mysql.html">mysql</a> (requires <code>#include "soci-mysql.h"</code>)</li>
<li><a href="backends/oracle.html">oracle</a> (requires <code>#include "soci-oracle.h"</code>)</li>
<li><a href="backends/postgresql.html">postgresql</a> (requires <code>#include "soci-postgresql.h"</code>)</li>
</ul>
<p>The following backends are also available, with various levels of completeness:</p>
<ul>
<li><a href="backends/sqlite3.html">sqlite3</a> (requires <code>#include "soci-sqlite3.h"</code>)</li>
<li><a href="backends/odbc.html">odbc</a> (requires <code>#include "soci-odbc.h"</code>)</li>
<li><a href="backends/firebird.html">firebird</a> (requires <code>#include "soci-firebird.h"</code>) </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.12
</small></address>
</body>
</html>
