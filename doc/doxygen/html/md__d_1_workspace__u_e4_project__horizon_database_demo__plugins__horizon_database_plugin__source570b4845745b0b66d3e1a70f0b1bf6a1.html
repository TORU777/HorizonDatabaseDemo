<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HorizonDatabasePlugin: ODBC Backend Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HorizonDatabasePlugin
   &#160;<span id="projectnumber">0.1.0</span>
   </div>
   <div id="projectbrief">SOCI wrapper for UE4(beta)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">ODBC Backend Reference </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><ul>
<li><a href="#prerequisites">Prerequisites</a><ul>
<li><a href="#versions">Supported Versions</a></li>
<li><a href="#tested">Tested Platforms</a></li>
<li><a href="#required">Required Client Libraries</a></li>
</ul>
</li>
<li><a href="#connecting">Connecting to the Database</a></li>
<li><a href="#support">SOCI Feature Support</a><ul>
<li><a href="#dynamic">Dynamic Binding</a></li>
<li><a href="#name">Binding by Name</a></li>
<li><a href="#bulk">Bulk Operations</a></li>
<li><a href="#transactions">Transactions</a></li>
<li><a href="#blob">BLOB Data Type</a></li>
<li><a href="#rowid">RowID Data Type</a></li>
<li><a href="#nested">Nested Statements</a></li>
<li><a href="#stored">Stored Procedures</a></li>
</ul>
</li>
<li><a href="#native">Accessing the Native Database API</a></li>
<li><a href="#extensions">Backend-specific Extensions</a><ul>
<li><a href="#odbcsocierror">odbc_soci_error</a></li>
</ul>
</li>
<li><a href="#configuration">Configuration options</a></li>
</ul>
<h3><a class="anchor" id="prerequisites"></a> Prerequisites</h3>
<h4><a class="anchor" id="versions"></a> Supported Versions</h4>
<p>The SOCI ODBC backend is supported for use with ODBC 3.</p>
<h4><a class="anchor" id="tested"></a> Tested Platforms</h4>
<table class="doxtable">
</table>
<p>ODBC version</p>
<p>Operating System</p>
<p>Compiler </p>
<p>3</p>
<p>Linux (Ubuntu 12.04)</p>
<p>g++ 4.6.3 </p>
<p>3</p>
<p>Linux (Ubuntu 12.04)</p>
<p>clang 3.2 </p>
<p>3.8</p>
<p>Windows 8</p>
<p>Visual Studio 2012 </p>
<p>3</p>
<p>Windows 7</p>
<p>Visual Studio 2010 </p>
<p>3</p>
<p>Windows XP</p>
<p>Visual Studio 2005 (express) </p>
<p>3</p>
<p>Windows XP</p>
<p>Visual C++ 8.0 Professional </p>
<p>3</p>
<p>Windows XP</p>
<p>g++ 3.3.4 (Cygwin) &lt;/tbody&gt; </p>
<h4><a class="anchor" id="required"></a> Required Client Libraries</h4>
<p>The SOCI ODBC backend requires the ODBC client library.</p>
<h3><a class="anchor" id="connecting"></a> Connecting to the Database</h3>
<p>To establish a connection to the ODBC database, create a Session object using the <code>ODBC</code> backend factory together with a connection string: </p><pre class="fragment">backend_factory const&amp;amp; backEnd = odbc;
session sql(backEnd, "filedsn=c:\\my.dsn");
</pre><p>or simply: </p><pre class="fragment">session sql(odbc, "filedsn=c:\\my.dsn");
</pre><p>The set of parameters used in the connection string for ODBC is the same as accepted by the <code>[SQLDriverConnect](<a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/odbcsql/od_odbc_d_4x4k.asp">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/odbcsql/od_odbc_d_4x4k.asp</a>)</code> function from the ODBC library.</p>
<p>Once you have created a <code>session</code> object as shown above, you can use it to access the database, for example: </p><pre class="fragment">int count;
sql &lt;&lt; "select count(*) from invoices", into(count);
</pre><p>(See the <a href="../basics.html">SOCI basics</a> and <a href="../exchange.html">exchanging data</a> documentation for general information on using the <code>session</code> class.)</p>
<h3><a class="anchor" id="support"></a> SOCI Feature Support</h3>
<h4><a class="anchor" id="dynamic"></a> Dynamic Binding</h4>
<p>The ODBC backend supports the use of the SOCI <code>row</code> class, which facilitates retrieval of data whose type is not known at compile time.</p>
<p>When calling <code>row::get&lt;T&gt;()</code>, the type you should pass as T depends upon the underlying database type. For the ODBC backend, this type mapping is:</p>
<table class="doxtable">
</table>
<p>ODBC Data Type </p>
<p>SOCI Data Type </p>
<p><code>row::get&lt;T&gt;</code> specializations  </p>
<p>SQL_DOUBLE , SQL_DECIMAL , SQL_REAL , SQL_FLOAT , SQL_NUMERIC  </p>
<p><code>dt_double</code> </p>
<p><code>double</code>  </p>
<p>SQL_TINYINT , SQL_SMALLINT , SQL_INTEGER , SQL_BIGINT </p>
<p><code>dt_integer</code> </p>
<p><code>int</code>  </p>
<p>SQL_CHAR, SQL_VARCHAR </p>
<p><code>dt_string</code> </p>
<p><code>std::string</code>  </p>
<p>SQL_TYPE_DATE , SQL_TYPE_TIME , SQL_TYPE_TIMESTAMP </p>
<p><code>dt_date</code> </p>
<p><code>std::tm</code>  &lt;/tbody&gt; </p>
<p>Not all ODBC drivers support all datatypes.</p>
<p>(See the <a href="../exchange.html#dynamic">dynamic resultset binding</a> documentation for general information on using the <code>row</code> class.)</p>
<h4><a class="anchor" id="name"></a> Binding by Name</h4>
<p>In addition to <a href="../exchange.html#bind_position">binding by position</a>, the ODBC backend supports <a href="../exchange.html#bind_name">binding by name</a>, via an overload of the <code><a class="el" href="namespacesoci.html#a9f59a2e8d19664d5e1eae175936f1b4e">use()</a></code> function: </p><pre class="fragment">int id = 7;
sql &lt;&lt; "select name from person where id = :id", use(id, "id")
</pre><p>Apart from the portable "colon-name" syntax above, which is achieved by rewriting the query string, the backend also supports the ODBC ? syntax: </p><pre class="fragment">int i = 7;
int j = 8;
sql &lt;&lt; "insert into t(x, y) values(?, ?)", use(i), use(j);
</pre><h4><a class="anchor" id="bulk"></a> Bulk Operations</h4>
<p>The ODBC backend has support for SOCI's <a href="../statements.html#bulk">bulk operations</a> interface. Not all ODBC drivers support bulk operations, the following is a list of some tested backends:</p>
<table class="doxtable">
</table>
<p>ODBC Driver </p>
<p>Bulk Read </p>
<p>Bulk Insert  </p>
<p>MS SQL Server 2005 </p>
<p>YES </p>
<p>YES  </p>
<p>MS Access 2003 </p>
<p>YES </p>
<p>NO  </p>
<p>PostgresQL 8.1 </p>
<p>YES </p>
<p>YES  </p>
<p>MySQL 4.1 </p>
<p>NO </p>
<p>NO  &lt;/tbody&gt; </p>
<h4><a class="anchor" id="transactions"></a> Transactions</h4>
<p><a href="../statements.html#transactions">Transactions</a> are also fully supported by the ODBC backend, provided that they are supported by the underlying database.</p>
<h4>BLOB Data Type</h4>
<p>Not currently supported.</p>
<h4>RowID Data Type</h4>
<p>Not currently supported.</p>
<h4>Nested Statements</h4>
<p>Not currently supported.</p>
<h4>Stored Procedures</h4>
<p>Not currently supported.</p>
<h3><a class="anchor" id="native"></a> Acessing the native database API</h3>
<p>SOCI provides access to underlying datbabase APIs via several getBackEnd() functions, as described in the <a href="../beyond.html">beyond SOCI</a> documentation.</p>
<p>The ODBC backend provides the following concrete classes for navite API access:</p>
<table class="doxtable">
</table>
<p>Accessor Function </p>
<p>Concrete Class  </p>
<p><code>session_backend* session::get_backend()</code> </p>
<p><code>odbc_statement_backend</code>  </p>
<p><code>statement_backend* statement::get_backend()</code> </p>
<p><code>odbc_statement_backend</code>  </p>
<p><code>rowid_backend* rowid::get_backend()</code> </p>
<p><code>odbc_rowid_backend</code>  &lt;/tbody&gt; </p>
<h3><a class="anchor" id="extensions"></a> Backend-specific extensions</h3>
<h4><a class="anchor" id="odbcsocierror"></a> odbc_soci_error</h4>
<p>The ODBC backend can throw instances of class <code>odbc_soci_error</code>, which is publicly derived from <code>soci_error</code> and has additional public members containing the ODBC error code, the Native database error code, and the message returned from ODBC: </p><pre class="fragment">int main()
{
    try
    {
        // regular code
    }
    catch (soci::odbc_soci_error const&amp;amp; e)
    {
        cerr &lt;&lt; "ODBC Error Code: " &lt;&lt; e.odbc_error_code() &lt;&lt; endl
             &lt;&lt; "Native Error Code: " &lt;&lt; e.native_error_code() &lt;&lt; endl
             &lt;&lt; "SOCI Message: " &lt;&lt; e.what() &lt;&lt; std::endl
             &lt;&lt; "ODBC Message: " &lt;&lt; e.odbc_error_message() &lt;&lt; endl;
    }
   catch (exception const &amp;amp;e)
    {
        cerr &lt;&lt; "Some other error: " &lt;&lt; e.what() &lt;&lt; endl;
    }
}
</pre><h4><a class="anchor" id="getconenctionstring"></a> get_connection_string()</h4>
<p>The <code>odbc_session_backend</code> class provides <code>std::string get_connection_string() const</code> method that returns fully expanded connection string as returned by the <code>SQLDriverConnect</code> function.</p>
<h3><a class="anchor" id="configuration"></a> Configuration options</h3>
<p>This backend supports <code>odbc_option_driver_complete</code> option which can be passed to it via <code>connection_parameters</code> class. The value of this option is passed to <code>SQLDriverConnect()</code> function as "driver completion" parameter and so must be one of <code>SQL_DRIVER_XXX</code> values, in the string form. The default value of this option is <code>SQL_DRIVER_PROMPT</code> meaning that the driver will query the user for the user name and/or the password if they are not stored together with the connection. If this is undesirable for some reason, you can use <code>SQL_DRIVER_NOPROMPT</code> value for this option to suppress showing the message box: </p><pre class="fragment">connection_parameters parameters("odbc", "DSN=mydb");
parameters.set_option(odbc_option_driver_complete, "0" /* SQL_DRIVER_NOPROMPT */);
session sql(parameters); </pre> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.12
</small></address>
</body>
</html>
